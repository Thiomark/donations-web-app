@{
    ViewData["Title"] = "Home Page";
}

<main class="home mt-10">
    <div class='grid grid-cols-1 lg:grid-rows-2 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-3'>
        <div>
            <div class="grid-cols-2 grid gap-4 h-full rounded">
                <div class="bg-orange-500 h-full flex flex-column align-items-center justify-center">
                    <p class="text-xl text-center uppercase font-bold">
                        Total number of <span class="block">goods received</span>
                    </p>
                    <h1 id="goodsReceivedCount" class="text-5xl font-bold">0</h1>
                </div>
                <div class="bg-gray-100 h-full flex flex-column align-items-center justify-center">
                    <p class="text-xl text-center uppercase font-bold">
                        Total number of <span class="block">allocated Goods</span>
                    </p>
                    <h1 id="goodsAllocatedCount" class="text-5xl font-bold">0</h1>
                </div>
            </div>
        </div>
        <div class="bg-gray-100 h-full flex flex-column align-items-center justify-center space-y-6 py-8">
            <div class="text-center">
                <h1 class="text-4xl font-bold" id="moneyDonationsMade">R 0</h1>
                <h2 class="font-bold">Monetary donation made</h2>
            </div>
            <div class="text-center">
                <h1 class="text-4xl font-bold" id="moneyDonationsAllocated">R 0</h1>
                <h2 class="font-bold">Allocated to disasters</h2>
            </div>
            <a class="bg-green-500 uppercase text-gray-200 items-center flex text-xs py-3 px-10 font-bold" asp-area="" asp-controller="MoneyDonations" asp-action="Index">
                Donate
            </a>
        </div>
        <div class="h-full hidden lg:block row-span-2" style="background-image: url('https://images.pexels.com/photos/8581019/pexels-photo-8581019.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1');">

        </div>
        
        <div class="bg-gray-100">
            <div class="grid bg-gray-200 grid-cols-4 font-bold p-2 uppercase text-gray-600 text-xs">
                <span class="col-span-2">Active disasters</span>
                <span class="">Allocated</span>
                <span class="">Allocated To</span>
            </div>
            <ul id="activeDisasters" class="w-full divide-y divide-white border-b border-gray-100 max-h-[15em] overflow-auto">
                
            </ul>
        </div>
        
        <div class="bg-purple-500 flex flex-col items-center space-y-3 p-10 text-white text-center justify-center">
            <h1 class="font-bold text-4xl">We are a non-profit organisation</h1>
            <p class="text-lg text-gray-200">Disaster Alleviation Foundation is the global leader in online fundraising.</p>
        </div>
    </div>
    <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item">
                <img class="d-block h-[60vh] w-full" src="https://images.pexels.com/photos/6646904/pexels-photo-6646904.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="First slide">
            </div>
            <div class="carousel-item active">
                <img class="d-block h-[60vh] w-full" src="https://images.pexels.com/photos/6995247/pexels-photo-6995247.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Second slide">
            </div>
            <div class="carousel-item">
                <img class="d-block h-[60vh] w-full" src="https://images.pexels.com/photos/8060425/pexels-photo-8060425.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Third slide">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <div class="card-group lg:space-x-4">
        <div class="card">
            <img class="card-img-top h-[20em]" src="https://images.pexels.com/photos/45842/clasped-hands-comfort-hands-people-45842.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Give a hand to make</h5>
                <p class="card-text">Help the neddy people. Make big changes & help the world</p>
            </div>
        </div>
        <div class="card">
            <img class="card-img-top h-[20em]" src="https://images.pexels.com/photos/7156184/pexels-photo-7156184.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Together with you</h5>
                <p class="card-text">Disaster relief, helping the people who need it the most with shelter, food, and water</p>
            </div>
        </div>
        <div class="card">
            <img class="card-img-top h-[20em]" src="https://images.pexels.com/photos/167964/pexels-photo-167964.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title">Ways you can make a difference</h5>
                <p class="card-text">We bring together people, churches and businesses to fund high-impact organizations that tackle the needs of the very poor and vulnerable.</p>
            </div>
        </div>
    </div>
</main>


@section Scripts {
    <script type="text/javascript">
        $(document).ready(function () {
            var i = 1;
            (function () {
                try {
                    $.ajax({
                        url: "/AllocateGoods/GetHomeInfo",
                        datatype: "JSON",
                        type: "Get",
                        success: function (data) {
                            document.querySelector("#goodsReceivedCount").innerHTML = data.goodsReceivedCount.toString();
                            document.querySelector("#moneyDonationsAllocated").innerHTML = data.moneyDonationsAllocated.toString();
                            document.querySelector("#moneyDonationsMade").innerHTML = data.moneyDonationsMade.toString();
                            document.querySelector("#goodsAllocatedCount").innerHTML = data.goodsAllocatedCount.toString();

                            let activeDisasters = document.querySelector("#activeDisasters");

                            const allDonationsMade = [...data.allocatedGoodsDonations, ...data.allocatedMoneyDonations];
                            allDonationsMade.forEach(item => {
                                const donatedItem = item.amount ? 'R ' + item.amount : item.goods
                                var li = document.createElement("li");
                                li.setAttribute("class", "grid grid-cols-4 p-2 text-sm");
                                li.innerHTML = `
                                    <span class="col-span-2 truncate w-[95%]">${item.description ?? ''}</span>
                                    <span class="font-bold text-gray-700">${donatedItem}</span>
                                    <span class="">${item.allocatedTo}</span>
                                `;
                                activeDisasters.appendChild(li);
                            })
                            console.log(allDonationsMade); 
                        }
                    });
                } catch (e) {
                    console.log(e.message);
                }
            })();
        });
    </script>
}
